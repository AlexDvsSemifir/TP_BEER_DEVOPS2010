SELECT 
    NUMERO_TICKET, SUM(QUANTITE) AS qte
FROM
    ventes
WHERE
    ventes.QUANTITE < 50
GROUP BY NUMERO_TICKET
HAVING qte > 500
ORDER BY qte DESC;